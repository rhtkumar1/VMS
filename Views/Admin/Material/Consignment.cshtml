@model IMS.Models.ViewModel.Consignment
@{
    ViewBag.Title = "Consignment";
    Layout = "~/Views/Shared/DashBoard/_Layout.cshtml";
}
<script src="~/assets/consignment.js"></script>
@{
    var AppToken = Convert.ToString(@Model.AppToken);
}
<div id="page-wrapper" class="gray-bg dashbard-1">
    <div class="content-main">
        <!--banner-->
        <div class="banner">
            <h2>
                <a href="/admin/dashboard">Home</a>
                <i class="fa fa-shopping-cart"></i>
                <span>Consignment</span>
            </h2>
        </div>
        <!--//banner-->
        <!--content-->
        <div id="modelForm">
            <div class="blank">
                <div class="blank-page">
                    @Html.Partial("~/Views/Shared/_MessageBox.cshtml")
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 form-group pull-right">
                        @using (Html.BeginForm("ManageConsignment", "Material", FormMethod.Post, new { @id = "ManageConsignment" }))
                        {
                            @*@Html.HiddenFor(m => m.SaleId, htmlAttributes: new { @id = "SaleId" })*@
                            @Html.HiddenFor(m => m.AppToken)
                            @Html.HiddenFor(m => m.IsUpdateConsignment, htmlAttributes: new { @id = "IsUpdateConsignment" })
                            @Html.HiddenFor(m => m.CSGLine, htmlAttributes: new { @id = "ConsignmentLines" })

                            @*@Html.HiddenFor(m => m.IsUpdateMaterialSales, htmlAttributes: new { @id = "IsUpdateMaterialSales", @value = "0" })
            @Html.HiddenFor(m => m.SaleLine, htmlAttributes: new { @id = "SaleLine" })
            @Html.HiddenFor(m => m.SupplyStateId, htmlAttributes: new { @id = "SupplyStateId" })
            @Html.HiddenFor(m => m.PartyId, htmlAttributes: new { @id = "PartyId" })
            @Html.HiddenFor(m => m.POId, htmlAttributes: new { @id = "POId" })*@

                            <div class="heading">
                                <h4>
                                    Basic Details
                                </h4>
                            </div>
                            <br />
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>GR TYPE <span class="mandatory">*</span></label>
                                    @Html.DropDownListFor(m => m.TypeId, new SelectList(Model.GR_List, "Value", "Text"), htmlAttributes: new { @id = "Type_Id", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>CLIENT NAME<span class="mandatory">*</span></label>
                                    @Html.DropDownListFor(m => m.Client_Id, new SelectList(Model.PartyLists, "Value", "Text"), htmlAttributes: new { @id = "Client_Id", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>GR OFFICE</label>
                                    @Html.DropDownListFor(m => m.GR_OfficeId, new SelectList(Model.Office_List, "Value", "Text"), htmlAttributes: new { @id = "GR_OfficeId", @class = "form-control" })
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>CONSIGNEE<span class="mandatory">*</span></label>
                                    @Html.DropDownListFor(m => m.Consignee_Id, new SelectList(Model.PartyLists, "Value", "Text"), htmlAttributes: new { @id = "Consignee_Id", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>BILLING OFFICE<span class="mandatory">*</span></label>
                                    @Html.DropDownListFor(m => m.Billing_OfficeId, new SelectList(Model.Office_List, "Value", "Text"), htmlAttributes: new { @id = "Billing_OfficeId", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>CONSIGNER<span class="mandatory">*</span></label>
                                    @Html.DropDownListFor(m => m.Consigner_Id, new SelectList(Model.PartyLists, "Value", "Text"), htmlAttributes: new { @id = "Consigner_Id", @class = "form-control" })
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>GR Date<span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.GR_Date, htmlAttributes: new { @id = "GR_Date", @placeholder = "dd/mm/yyyy", @Value = @DateTime.Now.ToString("dd/MM/yyyy"),  @class = "form-control clsDate" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>ORIGIN<span class="mandatory">*</span></label>
                                    @Html.DropDownListFor(m => m.Origin_Id, new SelectList(Model.LocationLists, "Value", "Text"), htmlAttributes: new { @id = "Origin_Id", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>GR NO<span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.GR_No, htmlAttributes: new { @id = "GR_No", @class = "form-control" })
                                    @*@Html.TextBox("GR_No", "", htmlAttributes: new { @placeholder = "GR_No", @id = "GR_No", @class = "form-control" })*@
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>DESTINATION<span class="mandatory">*</span></label>
                                    @Html.DropDownListFor(m => m.Destination_Id, new SelectList(Model.LocationLists, "Value", "Text"), htmlAttributes: new { @id = "Destination_Id", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>VEHICLE NO<span class="mandatory">*</span></label>
                                    @Html.DropDownListFor(m => m.Vehicle_Id, new SelectList(Model.Vehicle_List, "Value", "Text"), htmlAttributes: new { @id = "Vehicle_Id", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>CONTRACT NAME<span class="mandatory">*</span></label>
                                    @Html.DropDownListFor(m => m.Contract_Id, new SelectList(Model.PartyLists, "Value", "Text"), htmlAttributes: new { @id = "Contract_Id", @class = "form-control" })
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div>
                                <div class="styled-input">
                                    <div class="heading">
                                        <h4>
                                            Add/Update Material Detail
                                        </h4>
                                    </div>
                                    <br />
                                </div>
                                <div class="styled-input">
                                    <div class="col-md-3 form-group">
                                        <label>MATERIAL NAME</label>
                                        <input type="text" id="ItemSearch" name="ItemSearch" placeholder="Search Item" class="form-control" />
                                        <input type="hidden" id="Item_Id" name="Item_Id" value="" />
                                    </div>
                                </div>
                                <div class="styled-input">
                                    <div class="col-md-3 form-group">
                                        <label>ACTUAL WEIGHT</label>
                                        @Html.TextBox("Actual_Weight", "", htmlAttributes: new { @placeholder = "Actual Weight", @id = "Actual_Weight", @class = "form-control" })
                                    </div>
                                </div>
                                <div class="styled-input">
                                    <div class="col-md-3 form-group">
                                        <label>CHARGE WEIGHT</label>
                                        @Html.TextBox("Charge_Weight", "", htmlAttributes: new { @placeholder = "Charge Weight", @id = "Charge_Weight", @class = "form-control" })
                                    </div>
                                </div>
                                <div class="styled-input">
                                    <div class="col-md-3 form-group">
                                        <label>NO. OF PCS</label>
                                        @Html.TextBox("Pcs", "", htmlAttributes: new { @placeholder = "Pcs", @id = "Pcs", @class = "form-control" })
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                                <div class="styled-input">
                                    <div class="col-md-3 form-group">
                                        <label>UNIT</label>
                                        @Html.DropDownList("Unit", new SelectList(Model.UnitLists, "Value", "Text"), htmlAttributes: new { @class = "form-control" })
                                    </div>
                                </div>
                                <div class="styled-input">
                                    <div class="col-md-3 form-group">
                                        <label>RATE TYPE</label>
                                        @Html.TextBox("Rate_Type", "", htmlAttributes: new { @placeholder = "Rate Type", @id = "Rate_Type", @class = "form-control" })
                                    </div>
                                </div>
                                <div class="styled-input">
                                    <div class="col-md-3 form-group">
                                        <label>RATE</label>
                                        @Html.TextBox("Rate", "", htmlAttributes: new { @placeholder = "Rate", @id = "Rate", @class = "form-control" })
                                    </div>
                                </div>
                                <div class="styled-input">
                                    <div class="col-md-3 form-group">
                                        <label>BASIC FREIGHT</label>
                                        @Html.TextBox("Basic_Freight", "", htmlAttributes: new { @placeholder = "Basic Freight", @id = "Basic_Freight", @class = "form-control" })
                                    </div>
                                </div>
                                <div class="col-md-12 form-group" style="text-align:right">
                                    <label>Action</label>
                                    <br />
                                    <a id="btnAdd" name="btnAdd" class="btn btn-primary"><i class="fa fa-plus"></i></a>
                                    <a id="btnReset" name="btnReset" class="btn btn-primary"><i class="fa fa-refresh"></i></a>
                                </div>
                                <div class="clearfix"></div>
                                <div class="clearfix"></div>
                                <div class="table-responsive">
                                    <table id="tblConsignment" class="table table-striped" cellpadding="0" cellspacing="0">
                                        <thead>
                                            <tr>
                                                <th class="tbl-heading">Action</th>
                                                <th class="tbl-heading">Material</th>
                                                <th class="tbl-heading">A-Weight</th>
                                                <th class="tbl-heading">C-Weight</th>
                                                <th class="tbl-heading">Pcs</th>
                                                <th class="tbl-heading">Unit</th>
                                                <th class="tbl-heading">Rate Type</th>
                                                <th class="tbl-heading">Rate</th>
                                                <th class="tbl-heading">Basic Freight</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tbodyid"></tbody>
                                    </table>
                                </div>
                                <div class="clearfix"></div>
                            </div>
                            <div class="heading">
                                <h4>
                                    Extra Charges Detail
                                </h4>
                            </div>
                            <br />
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>LOADING <span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.Loading, htmlAttributes: new { @placeholder = "Enter Loading", @id = "Loading", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>TWO POINT DELIVERY <span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.Two_Point_Delivery, htmlAttributes: new { @placeholder = "Two Point Delivery", @id = "Two_Point_Delivery", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>UNLOADING <span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.Unloading, htmlAttributes: new { @placeholder = "Unloading", @id = "Unloading", @class = "form-control" })
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>PICKUP <span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.Pickup, htmlAttributes: new { @placeholder = "Pickup", @id = "Pickup", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>DETENTION  <span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.Detention, htmlAttributes: new { @placeholder = "detention", @id = "detention", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>LOCAL DELIVERY <span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.Local_Delivery, htmlAttributes: new { @placeholder = "Local Delivery", @id = "Local_Delivery", @class = "form-control" })
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>OTHER CHARGE <span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.Other_Charge, htmlAttributes: new { @placeholder = "Other Charge", @id = "Other_Charge", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>HAMALI <span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.Hamali, htmlAttributes: new { @placeholder = "Hamali", @id = "Hamali", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>LABOUR <span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.Labour, htmlAttributes: new { @placeholder = "Labour", @id = "Labour", @class = "form-control" })
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>TOTAL FREIGHT <span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.Total_Freight, htmlAttributes: new { @placeholder = "Total Freight", @id = "Total_Freight", @class = "form-control" })
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="heading">
                                <h4>
                                    Advance Detail
                                </h4>
                            </div>
                            <br />
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>ADVANCE AMOUNT <span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.Advance_Amount, htmlAttributes: new { @placeholder = "Advance Amount", @id = "Advance_Amount", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>ADVANCE DATE <span class="mandatory">*</span></label>
                                    @Html.TextBoxFor(m => m.Advance_Date, htmlAttributes: new { @id = "Advance_Date", @placeholder = "dd/mm/yyyy", @Value = @DateTime.Now.ToString("dd/MM/yyyy"), @class = "form-control clsDate" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>CASH / BANK <span class="mandatory">*</span></label>
                                    @Html.DropDownListFor(m => m.Advance_LedgerId, new SelectList(Model.PartyLists, "Value", "Text"), htmlAttributes: new { @id = "Advance_LedgerId", @class = "form-control" })
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>DRIVER <span class="mandatory">*</span></label>
                                    @Html.DropDownListFor(m => m.Driver_Id, new SelectList(Model.Driver_List, "Value", "Text"), htmlAttributes: new { @id = "Driver_Id", @class = "form-control" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>IS AUTO BILL <span class="mandatory">*</span></label>
                                    @Html.CheckBoxFor(m => m.Is_Auto_Bill, new { @checked = "checked", @class = "checkboxcss", @id = "Is_Auto_Bill" })
                                </div>
                            </div>
                            <div class="styled-input">
                                <div class="col-md-4 form-group">
                                    <label>IS AUTO TRIP <span class="mandatory">*</span></label>
                                    @Html.CheckBoxFor(m => m.Is_Auto_Trip, new { @checked = "checked", @class = "checkboxcss", @id = "Is_Auto_Trip" })
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="clearfix"></div>
                            <div class="col-md-8"></div>
                            <div class="col-md-1 form-group pull-right">
                                <div class="appointment-btn text-lg-right">
                                    <button type="button" name="btnResetForm" id="btnResetForm" class="btncustome">Reset</button>
                                </div>
                            </div>
                            <div class="col-md-1 form-group pull-right">
                                <div class="appointment-btn text-lg-right">
                                    <input type="hidden" id="hdnApptoken" value="0" name="hdnApptoken" />
                                    <input type="hidden" id="hdnRowId" name="hdnRowId" value="" />
                                    <input type="hidden" id="hdnEditRow" name="hdnEditRow" value="" />
                                    <button type="submit" name="btnSubmit" id="btnSubmit" class="btncustome">Submit</button>
                                </div>
                            </div>
                            <div class="col-md-1 form-group pull-right">
                                <div style="display:none" id="divDeleteConsignment">
                                    <button type="button" name="btnDelete" id="btnDelete" class="btncustome">Delete</button>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
        <div class="clearfix"> </div>
    </div>
    <!--//content-->
    <!---->
</div>

<script type="text/javascript">
    $(document).ready(function () {
        if ('@ViewBag.Msg' != "") {
            $('#alertModal').modal('show');
            $('#msg').html("@ViewBag.Msg");
        }
        IMSConsignment.AppToken = '@Model.AppToken';
        $("#hdnApptoken").val(IMSConsignment.AppToken);
        IMSConsignment.Consignment();
    });
    
    $("#Labour").change(function () {
        debugger
        alert("The text has been changed.");
        var loding = $('#Loading').val();
        var tpd = $('#Two_Point_Delivery').val();
        var Unloading = $('#Unloading').val();
        var Pickup = $('#Pickup').val();
        var destination = $('#destination').val();
        var localdelevery = $('#Local_Delivery').val();
        var othercharge = $('#Other_Charge').val();
        var hamali = $('#Hamali').val();
        var labour = $('#Labour').val();

        var total = parseFloat(loding) + parseFloat(tpd) + parseFloat(Unloading) + parseFloat(Pickup) + parseFloat(destination)  + parseFloat(localdelevery) + parseFloat(othercharge) + parseFloat(hamali) + parseFloat(labour);
        $('#Total_Freight').val(total);
        $('#Total_Freight').prop('readonly', true);

    });
</script>